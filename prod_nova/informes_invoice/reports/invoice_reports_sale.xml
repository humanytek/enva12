<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data >
   <template id="report_invoice_document_nova2" inherit_id="web.report_assets_common">
      <xpath expr="." position="inside" >
        <link href="/informes_invoice/static/src/css/informes_invoice.css" rel="stylesheet" type="text/css"/>
        <link href="/informes_invoice/static/src/scss/background_nova.scss" rel="stylesheet" type="text/scss"/>
      </xpath>
    </template>

    <template id="external_layout">
        <t t-if="not o" t-set="o" t-value="doc"/>
        <t t-if="not company">
            <!-- Multicompany -->
           <t t-if="company_id">
                <t t-set="company" t-value="company_id"/>
            </t>
            <t t-elif="o and 'company_id' in o">
                <t t-set="company" t-value="o.company_id.sudo()"/>
            </t>
            <t t-else="else">
                <t t-set="company" t-value="res_company"/>
            </t>
        </t>
        <t t-if="company.external_report_layout_id" t-call="informes_invoice.external_layout_background_nova"><t t-raw="0"/></t>
        <t t-else="else" t-raw="0"/>
     </template>

   <template id="external_layout_background_nova">
        <!-- <div class="header">
            <div class="a_background_header">
            <div class="float-right">
                <h3 class="mt0 text-right" t-field="company.report_header"/>
            </div>
            <img t-if="company.logo" t-att-src="image_data_uri(company.logo)" class="float-left" alt="Logo"/>
            <div class="float-left company_address">
                <div>
                    <strong t-field="company.partner_id.name"/>
                </div>
                <span t-field="company.partner_id"
                    t-options='{"widget": "contact", "fields": ["address"], "no_marker": true}'/>
            </div>
            <div class="clearfix mb8"/>
            </div>
               <div class="Rotate-90">LA REPRODUCCIÓN NO AUTORIZADA DE ESTE COMPROBANTE CONSTITUYE UN DELITO EN LOS TERMINOS DE LA DISPOSICIONES FISCALES.</div>
        </div> -->
      <div class="header">
            <div>
            <div class="float-right">
                <h1 class="mt0 text-right pintar" t-field="company.report_header"/>
            </div>
            <img t-if="company.logo" t-att-src="image_data_uri(company.logo)" class="float-left" id="imglogo" alt="Logo"/>
            <div class="float-left company_address encabezado_derecho">
                <div>
                    <span class="pintar" t-field="company.partner_id.name"/>
                </div>
                <span class="datoscoorp" t-field="company.partner_id" t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;], &quot;no_marker&quot;: true}"/>
                <span class="datoscoorp">Corporativo Bosques de Duraznos 65-902 Col. Bosques de las lomas C.P.11700 México.</span> <br/>
                <span class="datoscoorp">Tel. (0155) 5596-1038 Fax:(0155) 5251-6383</span>
            </div>
            <div class="info">
              FR-FC-04<br />
              REV-01<br />
              Fecha de emisión 01/08/2009<br />
            </div>
           </div>
        </div>

        <div class="article a_report_layout_background" t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id">
            <t t-call="web.address_layout"/>
            <t t-raw="0"/>
        </div>

        <div class="footer o_background_footer">
            <div class="leyend text-center"><p>LA REPRODUCCIÓN NO AUTORIZADA DE ESTE COMPROBANTE CONSTITUYE UN DELITO EN LOS TERMINOS DE LA DISPOSICIONES FISCALES.</p></div>
            <div class="text-center">
                <ul class="list-inline">
                    <li t-if="company.phone" class="list-inline-item"><i class="fa fa-phone" role="img" aria-label="Phone" title="Phone"/> <span t-field="company.phone"/></li>
                    <li t-if="company.email" class="list-inline-item"><i class="fa fa-at" role="img" aria-label="Email" title="Email"/> <span t-field="company.email"/></li>
                    <li t-if="company.website" class="list-inline-item"><i class="fa fa-globe" role="img" aria-label="Website" title="Website"/> <span t-field="company.website"/></li>
                    <li t-if="company.vat" class="list-inline-item"><i class="fa fa-building-o" role="img" aria-label="Fiscal number"/><t t-esc="company.country_id.vat_label or 'Tax ID'"/>: <span t-field="company.vat"/></li>
                </ul>
                <div t-field="company.report_footer"/>
                <div t-if="report_type == 'pdf'" class="text-muted">
                    Page:
                    <span class="page"/>
                    of
                    <span class="topage"/>
                </div>
            </div>
        </div>
    </template>


    <template id="report_invoice_document_nova" inherit_id="account.report_invoice_document">



       <xpath expr="//div[@name='reference']" position="replace">
         <div name="order" class="col-auto" t-if="o.order_purchase_id">
             <strong>Orden de Compra:</strong>
             <p t-field="o.order_purchase_id"/>
         </div>
        <div name="agente" class="col-auto" t-if="o.user_id">
            <strong>Agente:</strong>
            <p t-field="o.user_id"/>
        </div>
        <div name="currency" class="col-auto" t-if="o.currency_id">
            <strong>Moneda:</strong>
            <p t-field="o.currency_id"/>
        </div>
        <div name="type_currency" class="col-auto" t-if="o.type_currency">
            <strong>T.C:</strong>
            <p t-field="o.type_currency"/>
        </div>
      </xpath>



      <xpath expr="//table[@name='invoice_line_table']" position="replace">
      <table t-attf-class="table table-sm" name="invoice_line_table">
        <thead>
            <tr>
                <t t-set="colspan" t-value="6"/>
                <th class="text-left"><span>Description</span></th>
                <th t-if="o.l10n_mx_edi_cfdi_uuid and xml.get('Version')">
                    <span>Product code</span>
                    <t t-set="colspan" t-value="colspan+1"/>
                </th>
                <th class="d-none text-left"><span>Source Document</span></th>
                <th class="text-right"><span>Quantity</span></th>
                <th class="text-right" t-if="o.l10n_mx_edi_cfdi_uuid and xml.get('Version')">
                    <span>Unit code</span>
                    <t t-set="colspan" t-value="colspan+1"/>
                </th>
                <th t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}"><span>Unit Price</span></th>
                <th t-if="display_discount" t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                    <span>Disc.(%)</span>
                    <t t-set="colspan" t-value="colspan+1"/>
                </th>
                <th t-attf-class="text-left {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}"><span>Taxes</span></th>
                <th class="text-right">
                    <span >Amount</span>
                    <!-- <span groups="account.group_show_line_subtotals_tax_included">Total Price</span> -->
                </th>
            </tr>
        </thead>
        <tbody class="invoice_tbody">
            <t t-set="current_subtotal" t-value="0"/>

            <t t-foreach="o.invoice_line_ids" t-as="line">

                <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                <t t-set="current_subtotal" t-value="current_subtotal + line.price_total" groups="account.group_show_line_subtotals_tax_included"/>

                <tr t-att-class="'bg-200 font-weight-bold' if line.display_type == 'line_section' else 'font-italic' if line.display_type == 'line_note' else ''">
                    <t t-if="not line.display_type" name="account_invoice_line_accountable">
                        <td name="account_invoice_line_name"><span t-field="line.name"/></td>
                        <td t-if="o.l10n_mx_edi_cfdi_uuid and xml.get('Version')">
                          <span t-field="line.product_id.l10n_mx_edi_code_sat_id.code"/>
                        </td>
                        <td class="d-none"><span t-field="line.origin"/></td>
                        <td class="text-right">
                            <span t-field="line.quantity"/>
                            <span t-field="line.uom_id"  groups="uom.group_uom"/>
                        </td>
                          <td class="text-right" t-if="o.l10n_mx_edi_cfdi_uuid and xml.get('Version')">
                            <span t-field="line.uom_id.l10n_mx_edi_code_sat_id.code"/>
                          </td>
                        <td t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                            <span t-field="line.price_unit" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                        </td>
                        <td t-if="display_discount" t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                            <span t-field="line.discount"/>
                        </td>
                        <td t-attf-class="text-left {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                            <span t-esc="', '.join(map(lambda x: (x.description or x.name), line.invoice_line_tax_ids))"/>
                        </td>
                        <td class="text-right">
                            <span t-field="line.price_subtotal" />
                            <!-- <span t-field="line.price_total" groups="account.group_show_line_subtotals_tax_included"/> -->
                        </td>
                    </t>
                    <t t-if="line.display_type == 'line_section'">
                        <td t-att-colspan="colspan">
                            <span t-field="line.name"/>
                        </td>
                        <t t-set="current_section" t-value="line"/>
                        <t t-set="current_subtotal" t-value="0"/>
                    </t>
                    <t t-if="line.display_type == 'line_note'">
                        <td t-att-colspan="colspan">
                            <span t-field="line.name"/>
                        </td>
                    </t>
                </tr>
                <tr>
                  <td name="trasladados" class="text-center">
                      <span>TRASLADADOS</span>
                  </td>
                  <td name="base" class="text-center">
                      <span>BASE</span>
                  </td>
                  <td name="impuesto" class="text-center">
                      <span>IMPUESTO</span>
                  </td>
                  <td name="factor" class="text-center">
                      <span>T. FACTOR</span>
                  </td>
                  <td name="tasa" class="text-center">
                      <span>TASA</span>
                  </td>
                  <td name="importe" class="text-center">
                      <span>IMPORTE</span>
                  </td>
                </tr>
                <tr>
                  <td name="trasladados" class="text-center">

                  </td>
                  <td name="base" class="text-center">
                        <span t-field="line.price_subtotal_signed" />
                  </td>
                  <td name="impuesto" class="text-center">
                      <span>IVA</span>
                  </td>
                  <td name="factor" class="text-center">
                    <span>02 TASA</span>
                  </td>
                  <td name="tasa" t-if="line.invoice_line_tax_ids.amount == 16 " class="text-center">
                      <span t-esc="line.invoice_line_tax_ids.amount/100 "/>
                  </td>
                  <td name="tasa" t-if="line.invoice_line_tax_ids.amount == 0 " class="text-center">
                      <span>0.00</span>
                  </td>
                  <td name="importe" class="text-center">
                    <span t-field="line.price_tax"/>
                  </td>
                </tr>


                <tr t-if="o.partner_id.name == 'VF SOURCING LATIN AMERICA SARL'">
                  <td colspan="7" class="text-center"><span>EXPORT 18 28 3506 8009376</span><br/><span>IMPORT 18 28 7042 8000106</span></td>
                </tr>
                <tr t-if="o.partner_id.name == 'ALIMENTOS Y BEBIDAS LA ESTANCIA'">
                  <td colspan="7"><span>PAIS DE ORIGEN: MEXICO CONDICION DE COMPRA: INCOTERM FOB, PUERTO PROGRESO, MEXICO CODIGO ARANCELARIO: 4808.1000 SEGUN CONTRATO 57/2017 CON FECHA 20/10/2017</span></td>
                </tr>
                <tr t-if="o.partner_id.name == 'EMPRESA COMERCIALIZADORA DE ACEITE, ECASOL'">
                  <td colspan="7"><span>PAIS DE ORIGEN: MEXICO CONDICION DE COMPRA: INCOTERM FOB, PUERTO PROGRESO, MEXICO CODIGO ARANCELARIO: 4808.1000 SEGUN SUPLEMENTO No.1 AL CONTRATO 529-0046-2017 CON FECHA 23/01/2018</span></td>
                </tr>
                <tr t-if="o.partner_id.name == 'LOS PORTALES S.A'">
                  <td colspan="7"><span>PAIS DE ORIGEN: MEXICO CONDICION DE COMPRA: INCOTERM FOB, PUERTO PROGRESO, MEXICO CODIGO ARANCELARIO: 4808.1000 SEGUN CONTRATO NO. LP-52-019/17-E SUPLEMENTO 2 CON FECHA 14/03/2018</span></td>
                </tr>
                <tr t-if="o.partner_id.name == 'HAVANA CLUB INTERNATIONAL S.A.'">
                  <td colspan="7"><span>PAIS DE ORIGEN: MEXICO CONDICION DE COMPRA: INCOTERM CFR, PUERTO MARIEL, CUBA CODIGO ARANCELARIO: 4819.1001 SEGUN CONTRATO I-153-18 CON FECHA 13/NOVIEMBRE/2018</span></td>
                </tr>
                <t t-if="current_section and (line_last or o.invoice_line_ids[line_index+1].display_type == 'line_section')">
                    <tr class="is-subtotal text-right">
                        <td t-att-colspan="colspan">
                            <strong class="mr16">Subtotal</strong>
                            <span  t-esc="current_subtotal" t-options='{"widget": "monetary", "display_currency": o.currency_id}' />
                        </td>
                    </tr>
                </t>
            </t>
        </tbody>
      </table>
      <table name="cfdi_origen" t-attf-class="table table-sm" t-if="o.l10n_mx_edi_origin" >
        <tr>
          <td><span>CDFI Relacionado: </span><span t-esc="o.l10n_mx_edi_origin[3:] if o.l10n_mx_edi_origin else ''"/></td>
        </tr>
        <tr>
          <td><span>Tipo de Relación:</span> <span t-esc="o.l10n_mx_edi_origin[:2] if o.l10n_mx_edi_origin else ''"/></td>
        </tr>
      </table>
      </xpath>

       <xpath expr="//p[@name='comment']" position="after">
        <p  name="comment1">
                        <span>Debo(mos) y pagaré(mos) en la ciudad de Mérida Yucatán incondicionalmente por este pagaré mercantil a la orden de EMPAQUES NOVA, S.A. DE C.V.
La cantidad de Valor de las mercancías arriba descritas y recibidas a mi (nuestra) entera satisfacción y que pagaré(mos) a su presentación este pagaré no es domiciliado y esta protegido por la Ley General de Títulos y Operaciones de Crédito.</span>
                    </p>
      </xpath>

    </template>




  </data>
</odoo>
